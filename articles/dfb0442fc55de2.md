---
title: "CSSグリッドで作るラッパー"
emoji: "🌟"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---

# はじめに
サイトコーディングをする際、コンテンツのレイアウトを揃えるために組むスタイル（以下ラッパーとします）があります。
具体的には以下のようなものを指します。

<!-- 画像 -->

こちらのラッパーですが、**CSSグリッド**を使うことでも実装が可能です。
また従来のアプローチ実現が難しかったレイアウトの実装も可能になるので、今回はその解説をいたします。

# 実装
下記が実際のコードになります。比較として二つのアプローチで実装したコードを用意しました。
二つの挙動に違いはありません。比較しながら説明に移ります。

<!-- 全体のコード -->

## 従来の方法
CSSグリッドを使わなかった従来の実装方法です。（コンテンツ幅を1080pxにした例）

```css
.container {
    max-width: 1080px;
    width: calc(100% - 20px * 2);
    margin-right: auto;
    margin-left: auto;

    /* width: min(1080px, 100% - 20px * 2); */
}
```

上記のスタイルによりサイト内のコンテンツを綺麗に揃えることが可能になります。

`calc()`を使うことのメリットとしては、
* 画面幅が max-width で設けた幅よりも大きい場合には、max値まで要素の幅が伸びきってくれる
* max-width の幅よりも画面幅が狭くなった場合に、画面の両端に指定したスペース分の余白を確保してくれること
の2点にあります。

※コメントアウト部分：ちなみに`min関数`を使うことで `max-width` と `width` の記述を1行で実装できます。`min関数`の中では`calc関数`は必要としません。

このラッパーのスタイルを、下記のような感じで使用することが多いのではないでしょうか。
（下記イメージ）

```html
<section class="about">
    <div class="container">
        <!-- コンテンツ -->
    </div>
</section>

<section class="feature">
    <div class="container">
        <!-- コンテンツ -->
    </div>
</section>
...
```

## CSS Gridを使った方法

上記の実装をCSS グリッドで実装すると下記のようなコードになります。（コンテンツ幅を1080pxにした例）

```css
.grid-container {
  display:grid;
  grid-template-columns: 1fr min(1080px, 100% - 20px * 2) 1fr;
}

.grid-container > * {
  grid-column: 2;
}
```

:::details コードについて詳しく

1. ラッパーにあたる要素に対して、`display: grid;` と `grid-template-columns`を指定します。
   *  `grid-template-columns` の指定により、画面では下記のような3列のグリッドレイアウトが形成されます。従来の実装にあった コンテンツの最大幅と縮み切った際の実装を２列目にて表現しています。![実装イメージ](/images/grid_sample.jpg)
   * 両端に指定した`1fr`により、画面幅に応じてコンテン外にあたる領域が伸び縮みしてくれるようになります。
2. ラッパーの子要素すべてに対して、columnを`2`と指定します。これは上で形成したグリッドレイアウトの中で`2列目`をコンテンツエリアとして割り当てることを意味します。これにより、コンテンツを中央に配置することが可能になります。

:::

上記コードで従来の方法と同じ挙動を実装することができます。
かえって複雑になってない？と思われた方もいらっしゃるかもしれないのですが、こちらの実装がどういう場面で活きてくるのかを説明します。

## 対象の要素を画面幅いっぱいに表示させたいとき

```css 
/* grid-column を使った実装 */
.full-width {
    grid-column: 1/-1;
}
```

要素に対して`grid-column: 1/-1;`の指定をするだけで、要素が画面幅いっぱいに表示してくれるようになります。
これは グリッドエリア上の スタートライン（グリッドエリア、ライン1本目の位置）から エンドライン（-1 で最後のライン位置を示します）まで要素が表示されるという意味を指します。

従来の方法では下記コードにて実装されることが多かったと思います。

```css 

/* 従来の実装 */
.full-width {
 width:100vw;
 margin: 0 calc(50% - 50vw);
}
```

しかしながら上記の実装ですが、下記の点が気になります。

* 画像要素に当てる上で注意が必要
  * divで括る必要がある
  * img の width に直接100%指定をしないといけない
* 直感的でない、小技的な側面が強い

従来の実装に対して、グリッドを使ったアプローチの方が直感的にかつ簡潔に実装できるので、スマートに書くことができます。

## 画面幅最大での水平スクロールエリアを作りたいとき

少し変わったレイアウトですが、こちらもCSSだけで実装できます。ラッパー幅を起点にしてかつ、画面幅全域で水平スクロールをするようなエリアです。
完全には違いますが、具体例だと下記のようなレイアウト想定しています。
（[Appleサイト](https://www.apple.com/jp/store)より）
[イメージ](https://gyazo.com/9a6f42051e53442b2932d24f1393a1cd)

下記が実装コードになります。

:::details コードについて詳しく

```html
<div class="grid-container">
    ...
  <div class="gallery">
    <div class="wrapper">
        <div class="card">
        <img src="https://placehold.jp/350x250.jpg" width="350" height="250" alt="">
        <p>タイトルが入ります。</p>
        </div>
        <div class="card">
        <img src="https://placehold.jp/350x250.jpg" width="350" height="250" alt="">
        <p>タイトルが入ります。</p>
        </div>
        <div class="card">
        <img src="https://placehold.jp/350x250.jpg" width="350" height="250" alt="">
        <p>タイトルが入ります。</p>
        </div>
        <div class="card">
        <img src="https://placehold.jp/350x250.jpg" width="350" height="250" alt="">
        <p>タイトルが入ります。</p>
        </div>
        <div class="card">
        <img src="https://placehold.jp/350x250.jpg" width="350" height="250" alt="">
        <p>タイトルが入ります。</p>
        </div>
        <div class="card">
        <img src="https://placehold.jp/350x250.jpg" width="350" height="250" alt="">
        <p>タイトルが入ります。</p>
        </div>
        <div class="card">
        <img src="https://placehold.jp/350x250.jpg" width="350" height="250" alt="">
        <p>タイトルが入ります。</p>
        </div>
        <div class="card">
        <img src="https://placehold.jp/350x250.jpg" width="350" height="250" alt="">
        <p>タイトルが入ります。</p>
        </div>
    </div>
  </div>
</div>

```

```css
.grid-container {
  display:grid;
  grid-template-columns: 1fr min(1080px, 100% - 20px * 2) 1fr;
}

.grid-container > * {
  grid-column: 2;
}

.gallery {
  display: grid;
  grid-column: 1/-1;
  grid-template-columns: inherit;
  overflow-x: scroll;
  overscroll-behavior-x: contain;
  scroll-snap-type: x mandatory;
  scrollbar-width: none;
}

.wrapper {
  display:flex;
  grid-column: 2;
}
```

【実装上の備考】
1. はじめに、グリッドエリアを画面幅いっぱいに表示させるために `grid-column: 1/-1;` を指定する。
2. 直下の子要素（`.wrapper`）の開始位置をラッパーエリアの頭に揃えるためには、下記の実装が必要になる。
   1. `.gallery` に`display: grid` と `grid-template-columns: inherit;` と指定する。親のグリッドレイアウトを継承するグリッドエリアを再定義する。
   2. 1をおこなうことで、直下の要素（`.wrapper`）にて`grid-column`が機能するようになる。該当の要素（`.wrapper`）に対して開始位置を**2**と指定すること（`grid-column:2;`）で、要素の開始位置をラッパーの頭に揃えることができる。
:::

上記の実装ですが少々複雑になので、詳細は[こちらの記事](https://ryanmulligan.dev/blog/x-scrolling-centered-max-width-container/)を参考にすると良いと思います。

このレイアウトの実装のなにが難しいのかといいますと、**コンテンツの配置をベースのラッパー幅に合わせてなおかつ画面幅いっぱいに水平スクロールさせる**という点です。
開始位置に関しては、paddingやmarginで余白を取って合わせることもできますが、ウィンドウをリサイズした際に他の要素と同一に同一に配置を揃えることが難しくなってくるため、ここの挙動もカバーするためにはおそらくJSによる実装が必要になってくるのではないかと考えています。