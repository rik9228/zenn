---
title: "[Astro] ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½œã£ã¦å©ãã¾ã§ï¼ˆSSG + SSRï¼‰"
emoji: "ğŸŒŸ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Astro", "tech"]
published: false
---

## ç›®çš„

- ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½œã£ã¦ãƒ•ãƒ­ãƒ³ãƒˆã‹ã‚‰å©ã„ã¦ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å–å¾—ã‚’ã™ã‚‹
- SSGæ§‹æˆãƒ™ãƒ¼ã‚¹ã§ã‹ã¤ã€éƒ¨åˆ†çš„ã«SSRã¨ã—ã¦æ©Ÿèƒ½ã•ã›ã‚‹

## å®Ÿè£…

ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ã¤ã„ã¦ã¯ã“ã¡ã‚‰
â€»åŸºæœ¬ã‚’SSGæ§‹æˆã§ã‚ã‚ŠãªãŒã‚‰ã€éƒ¨åˆ†çš„ã«SSRã•ã›ã¦ã„ã¾ã™ã€‚

### ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ä½œæˆ

> ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹ã«ã¯ã€.jsã¾ãŸã¯.tsãƒ•ã‚¡ã‚¤ãƒ«ã‚’/pagesãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«è¿½åŠ ã—ã¦ãã ã•ã„ã€‚.jsã¾ãŸã¯.tsã®æ‹¡å¼µå­ã¯ãƒ“ãƒ«ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ä¸­ã«å‰Šé™¤ã•ã‚Œã‚‹ã®ã§ã€ãƒ•ã‚¡ã‚¤ãƒ«åã«ã¯ä½œæˆã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã®æ‹¡å¼µå­ã‚’å«ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãŸã¨ãˆã°ã€src/pages/data.json.tsã¯ã€ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã¨/data.jsonã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨ãªã‚Šã¾ã™ã€‚

https://docs.astro.build/ja/guides/endpoints/#%E9%9D%99%E7%9A%84%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88

â†‘ å…¬å¼ã‹ã‚‰å¼•ç”¨ã§ã™ã€‚è¦ã™ã‚‹ã«ã€`/pages` é…ä¸‹ã«ä½œæˆã™ã‚‹ã“ã¨ã§ç°¡å˜ã«ä½œæˆã§ãã¡ã‚ƒã„ã¾ã™ã€‚

```typescript:pages/api/hello.ts
import type { APIRoute } from "astro";

// â†“â†“â†“ ouput ãŒ `hybrid` ãƒ¢ãƒ¼ãƒ‰ ã®å ´åˆã¯ prerender ã‚’ false ã«ã™ã‚‹ â†“â†“â†“
export const prerender = false;

export const GET: APIRoute = (context) => {
  const data = {
    message: 'Hello from custom endpoint!',
    timestamp: new Date().toISOString()
  };

  return new Response(JSON.stringify(data), {
    status: 200,
    headers: {
      "Content-Type": "application/json"
    }
  });
}
```

-> ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ç¾åœ¨ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’å«ã‚€JSONãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã—ã¾ã™ã€‚

### APIã‚’å©ã

Nextã§ã„ã†ã¨ã“ã‚ã® Route Handlerï¼ˆAPI Routesï¼‰ã‚’å®Ÿè¡Œã™ã‚‹å ´åˆã¯ã€ 
APIã‚’å©ããŸã„å ´æ‰€ã§å…ˆã»ã©ä½œã£ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã‚’æŒ‡å®šã—ã¦ã€fetchã™ã‚‹ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒå–å¾—ã§ãã¾ã™ã€‚

```html:pages/index.astro

...
      <h1>Astro Custom Endpoint Demo</h1>
      <p>
        Current Timeï¼š<span id="data-container"></span>
      </p>
    <script>
      async function fetchData() {
        const response = await fetch('/api/hello');
        const data = await response.json();

        document.getElementById('data-container').textContent = JSON.stringify(
          data.timestamp
        );
      }

      fetchData();
    </script>
...
```

## æœ€å¾Œã«

Astro ã§ç°¡å˜ã«APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚
ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰APIã‚’å©ãå¿…è¦ãŒã‚ã‚‹ã‘ã©ã€ã‚»ã‚­ãƒ¥ã‚¢ãªä½œã‚Šã«ã—ãŸã„ã¿ãŸã„ãªå ´åˆãªã©ã«æœ‰ç”¨ã§ã™ã€‚

å½“ãŸã‚Šå‰ã§ã™ãŒã€Node.js ãŒå®Ÿè¡Œã§ãã‚‹ç’°å¢ƒã«ä¾å­˜ã™ã‚‹ãŸã‚ã€
ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°é¸å®šã«ã¤ã„ã¦ã¯è¦èª¿æŸ»ãªã®ã¨ã‚µãƒ¼ãƒ“ã‚¹å…ˆã«ã‚ˆã£ã¦è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆastro.config.jsï¼‰ã§å¿…è¦ãªã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ãªã©ã®è¨˜è¿°å†…å®¹ãŒç•°ãªã£ã¦ãã‚‹ã®ã§ã€æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚

## å‚è€ƒæ–‡çŒ®

https://docs.astro.build/ja/guides/endpoints/
https://docs.astro.build/ja/guides/server-side-rendering/
